let restaurants,neighborhoods,cuisines;var newMap,markers=[];document.addEventListener("DOMContentLoaded",e=>{registerServiceWorker(),initMap(),fetchNeighborhoods(),fetchCuisines()}),fetchNeighborhoods=(()=>{DBHelper.fetchNeighborhoods((e,t)=>{e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})}),fillNeighborhoodsHTML=((e=self.neighborhoods)=>{const t=document.getElementById("neighborhoods-select");e.forEach(e=>{const a=document.createElement("option");a.innerHTML=e,a.value=e,t.append(a)})}),fetchCuisines=(()=>{DBHelper.fetchCuisines((e,t)=>{e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})}),fillCuisinesHTML=((e=self.cuisines)=>{const t=document.getElementById("cuisines-select");e.forEach(e=>{const a=document.createElement("option");a.innerHTML=e,a.value=e,t.append(a)})}),initMap=(()=>{self.newMap=L.map("map",{center:[40.722216,-73.987501],zoom:12,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoibGVtYSIsImEiOiJjamt0YXVla2MwM3NjM3dvZHQ0NDIwZmVpIn0.pOEFaPY6enCchIG29Lo2SQ",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),updateRestaurants()}),updateRestaurants=(()=>{const e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),a=e.selectedIndex,n=t.selectedIndex,r=e[a].value,s=t[n].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(r,s,(e,t)=>{e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})}),resetRestaurants=(e=>{self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers&&self.markers.forEach(e=>e.remove()),self.markers=[],self.restaurants=e}),fillRestaurantsHTML=((e=self.restaurants)=>{const t=document.getElementById("restaurants-list");e.forEach(e=>{t.append(createRestaurantHTML(e))}),addMarkersToMap()}),createRestaurantHTML=(e=>{const t=document.createElement("li"),a=document.createElement("picture");a.className="restaurant-picture",t.append(a);const n=document.createElement("source");n.media="(min-width: 750px)",n.srcset=`${DBHelper.imageUrlBasePath}${DBHelper.imageNameForRestaurant(e)}-800_large_1x.jpg 1x`,n.srcset+=`,${DBHelper.imageUrlBasePath}${DBHelper.imageNameForRestaurant(e)}-1200_large_2x.jpg 2x`,a.append(n);const r=document.createElement("source");r.media="(min-width: 500px)",r.srcset=`${DBHelper.imageUrlBasePath}${DBHelper.imageNameForRestaurant(e)}-medium.jpg`,a.append(r);const s=document.createElement("img");s.className="restaurant-img",s.src=DBHelper.imageUrlForRestaurant(e),s.alt="Image of the restaurant "+e.name,a.append(s);const o=document.createElement("div");o.className="restaurant-container",t.append(o);const c=document.createElement("div");c.className="restaurant-container__content",o.append(c);const i=document.createElement("h3");i.innerHTML=e.name,c.append(i);const l=document.createElement("p");l.innerHTML=e.neighborhood,c.append(l);const m=document.createElement("p");m.innerHTML=e.address,c.append(m);const p=document.createElement("a");return p.innerHTML="View Details",p.setAttribute("aria-label","View details of the restaurant "+e.name),p.href=DBHelper.urlForRestaurant(e),o.append(p),t}),addMarkersToMap=((e=self.restaurants)=>{e.forEach(e=>{const t=DBHelper.mapMarkerForRestaurant(e,self.newMap);t.on("click",function(){window.location.href=t.options.url}),self.markers.push(t)})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsicmVzdGF1cmFudHMiLCJuZWlnaGJvcmhvb2RzIiwiY3Vpc2luZXMiLCJuZXdNYXAiLCJtYXJrZXJzIiwiaW5pdE1hcCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsInJlZ2lzdGVyU2VydmljZVdvcmtlciIsImZldGNoTmVpZ2hib3Job29kcyIsImZldGNoQ3Vpc2luZXMiLCJEQkhlbHBlciIsImVycm9yIiwiY29uc29sZSIsInNlbGYiLCJmaWxsTmVpZ2hib3Job29kc0hUTUwiLCJmb3JFYWNoIiwiZG9jdW1lbnQiLCJuZWlnaGJvcmhvb2QiLCJvcHRpb24iLCJpbm5lckhUTUwiLCJ2YWx1ZSIsImZpbGxDdWlzaW5lc0hUTUwiLCJzZWxlY3QiLCJnZXRFbGVtZW50QnlJZCIsImN1aXNpbmUiLCJjcmVhdGVFbGVtZW50IiwiTCIsIm1hcCIsImNlbnRlciIsInpvb20iLCJzY3JvbGxXaGVlbFpvb20iLCJhdHRyaWJ1dGlvbiIsIm1heFpvb20iLCJ1cGRhdGVSZXN0YXVyYW50cyIsImNTZWxlY3QiLCJuU2VsZWN0IiwibkluZGV4Iiwic2VsZWN0ZWRJbmRleCIsImNJbmRleCIsImZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZCIsInJlc2V0UmVzdGF1cmFudHMiLCJtYXJrZXIiLCJyZW1vdmUiLCJmaWxsUmVzdGF1cmFudHNIVE1MIiwidWwiLCJyZXN0YXVyYW50IiwiY3JlYXRlUmVzdGF1cmFudEhUTUwiLCJsaSIsInBpY3R1cmUiLCJhcHBlbmQiLCJjbGFzc05hbWUiLCJzcmMxIiwic3Jjc2V0IiwiaW1hZ2VOYW1lRm9yUmVzdGF1cmFudCIsIm1lZGlhIiwiaW1hZ2VVcmxCYXNlUGF0aCIsInNyYzIiLCJpbWFnZSIsInNyYyIsImltYWdlVXJsRm9yUmVzdGF1cmFudCIsImFsdCIsIm5hbWUiLCJjb250YWluZXIiLCJjb250ZW50IiwiYWRkcmVzcyIsIm1vcmUiLCJzZXRBdHRyaWJ1dGUiLCJocmVmIiwidXJsRm9yUmVzdGF1cmFudCIsImFkZE1hcmtlcnNUb01hcCIsIm9uQ2xpY2siLCJ3aW5kb3ciLCJsb2NhdGlvbiIsIm1hcE1hcmtlckZvclJlc3RhdXJhbnQiLCJvcHRpb25zIiwidXJsIiwicHVzaCJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSUEsWUFHSkMsY0FDQUMsU0FFQSxJQUFBQyxPQUZJQyxRQUFVLEdBT1pDLFNBQU9DLGlCQUFJLG1CQUFBQyxJQURYQyx3QkFFQUMsVUFDQUMscUJBSkZBLGtCQVdFQyxtQkFBU0YsTUFDUEUsU0FBSUMsbUJBQU8sQ0FBQUEsRUFBQVgsS0FBRVcsRUFDWEMsUUFBUUQsTUFBTUEsSUFFZEUsS0FBS2IsY0FBZ0JBLEVBQ3JCYyw2QkFRTkEsc0JBQXdCLEVBQUNkLEVBQWdCYSxLQUFLYixpQkFBOUNjLE1BQUFBLEVBQUFBLFNBQXlCZCxlQUFnQmEsd0JBQ3ZDYixFQUFZZSxRQUFHQyxJQUNmaEIsTUFBQUEsRUFBY2UsU0FBUUUsY0FBZ0IsVUFDcENDLEVBQU1BLFVBQVNGLEVBQ2ZFLEVBQU9DLE1BQUFBLEVBQ1BELEVBQU9FLE9BQVBGLE9BUUpULGNBQWdCLE1BQ2RDLFNBQVNELGNBQWMsQ0FBQ0UsRUFBT1YsS0FEakNRLEVBQ0VDLFFBQVNELE1BQUFBLElBQ01JLEtBQUFaLFNBQUFBLEVBQ1hXLHdCQVdOUyxpQkFBbUIsRUFBQ3BCLEVBQVdZLEtBQUtaLFlBQ2xDLE1BQU1xQixFQUFTTixTQUFTTyxlQUFlLG1CQUV2Q3RCLEVBQVNjLFFBQVFTLElBSG5CSCxNQUFBQSxFQUFtQkwsU0FBU1MsY0FBUXhCLFVBQ2xDaUIsRUFBTUksVUFBU04sRUFFZmYsRUFBU2MsTUFBUVMsRUFDZkYsRUFBTUosT0FBTUEsT0FVaEJkLFFBQVUsTUFDUlMsS0FBS1gsT0FBU3dCLEVBQUVDLElBQUksTUFBTyxDQUNyQkMsT0FBUSxDQUFDLFdBQVksV0FDckJDLEtBQU0sR0FIUEMsaUJBQVMsSUFFUkYsRUFBQUEsVUFBUyxvRkFEWSxDQUVyQkMsWUFGcUIsd0ZBR3JCQyxRQUFBQSxHQUhOQyxZQUFBLDBOQU9FQyxHQUFBQSxtQkFDQUQsTUFBQUEsUUFIK0ZFLHNCQTJCbkdBLGtCQUFvQixNQUNsQixNQUFNQyxFQUFVbEIsU0FBU08sZUFBZSxtQkFDbENZLEVBQVVuQixTQUFTTyxlQUFlLHdCQURsQ1csRUFBT0EsRUFBR2xCLGNBQ1ZtQixFQUFPQSxFQUFHbkIsY0FHVm9CLEVBQVNELEVBQVFFLEdBQUFBLE1BRWpCYixFQUFVVSxFQUFRSSxHQUF4QmxCLE1BR0FWLFNBQVM2Qix3Q0FBd0NmLEVBQVNQLEVBQWMsQ0FBQ04sRUFBT1osS0FDMUVZLEVBQVNDLFFBQUFELE1BQUFBLElBQWI2QixpQkFFT3pDLEdBQ0x5QywyQkFTTkEsaUJBQW9CekMsQ0FBQUEsSUFBcEJ5QyxLQUFBQSxZQUFvQnpDLEdBQ2xCaUIsU0FBQU8sZUFBQSxvQkFDQVYsVUFBS2QsR0FLRGMsS0FBS1YsU0FBVFUsS0FBSUEsUUFBS1YsUUFBU3NDLEdBQUFBLEVBQUFDLFVBRWpCN0IsS0FBQVYsUUFBQSxHQUVEVSxLQUFLZCxZQUFjQSxJQU1yQjRDLG9CQUFzQixFQUFDNUMsRUFBY2MsS0FBS2QsZUFDeEMsTUFBTTZDLEVBQUs1QixTQUFTTyxlQUFlLG9CQUNuQ3hCLEVBQVlnQixRQUFROEIsSUFGdEJGLEVBQUFBLE9BQUFBLHFCQUFrQ0UsTUFFaEM5QyxvQkFTRitDLHFCQUF3QkQsQ0FBQUEsSUFDdEIsTUFBTUUsRUFBSy9CLFNBQVNTLGNBQWMsTUFFNUJ1QixFQUFVaEMsU0FBU1MsY0FBYyxXQUh6Q3FCLEVBQUFBLFVBQW9CLHFCQUNsQkMsRUFBQUUsT0FBUUQsR0FHUkEsTUFBQUEsRUFBUUUsU0FBWXpCLGNBQUEsVUFDcEJzQixFQUFHRSxNQUFPRCxxQkFFVkcsRUFBQUMsVUFBYXBDLFNBQVNTLG1CQUF0QmYsU0FBQTJDLHVCQUFBUix5QkFDQU0sRUFBS0csWUFBUTVDLFNBQUE2QyxtQkFBYjdDLFNBQUEyQyx1QkFBQVIsMEJBQ0FNLEVBQUtDLE9BQVVELEdBRWZILE1BQUFBLEVBQVFDLFNBQVJ4QixjQUFBLFVBRUErQixFQUFBRixNQUFhdEMscUJBQ2J3QyxFQUFLRixVQUFRNUMsU0FBQTZDLG1CQUFiN0MsU0FBQTJDLHVCQUFBUixnQkFDQVcsRUFBS0osT0FBVUksR0FHZixNQUFNQyxFQUFRekMsU0FBU1MsY0FBYyxPQUNyQ2dDLEVBQU1QLFVBQVksaUJBQ2xCTyxFQUFNQyxJQUFNaEQsU0FBU2lELHNCQUFzQmQsR0FDM0NZLEVBQU1HLElBQU0sMkJBQTZCZixFQUFXZ0IsS0FDcERiLEVBQVFDLE9BQU9RLEdBR2ZLLE1BQUFBLEVBQVVaLFNBQVl6QixjQUFBLE9BQ3RCc0IsRUFBVWUsVUFBVix1QkFFQWYsRUFBQUUsT0FBTWMsR0FFTkQsTUFBQUEsRUFBQTlDLFNBQUFTLGNBQUEsT0FFQXNDLEVBQU1GLFVBQU83QyxnQ0FDYjZDLEVBQUsxQyxPQUFZMEIsR0FHakIsTUFBTTVCLEVBQUFBLFNBQWVELGNBQVNTLE1BQzlCUixFQUFBQSxVQUFhRSxFQUFZMEIsS0FDekJrQixFQUFRZCxPQUFPaEMsR0FHZitDLE1BQUFBLEVBQW9CbkIsU0FBVXBCLGNBQTlCLEtBQ0FzQyxFQUFRZCxVQUFSSixFQUFBNUIsYUFFQThDLEVBQU1FLE9BQU9qRCxHQUViaUQsTUFBS0MsRUFBQUEsU0FBYXpDLGNBQWMsS0FDaEN3QyxFQUFLRSxVQUFldEIsRUFBQ3VCLFFBQ3JCTixFQUFBQSxPQUFVYixHQWhEWixNQUFBZ0IsRUFBQWpELFNBQUFTLGNBQUEsS0F3REE0QyxPQUhBSixFQUFBOUMsVUFBQSxlQVBFOEMsRUFBS0MsYUFBYSxhQUFjLGtDQUFvQ3JCLEVBQVdnQixNQUMvRUksRUFBS0UsS0FBT3pELFNBQVMwRCxpQkFBaUJ2QixHQUN0Q2lCLEVBQVViLE9BQU9nQixHQVFuQkksSUFLSUEsZ0JBQVNDLEVBQUFBLEVBQVV6RCxLQUFBZCxlQUNqQndFLEVBQU9DLFFBQVNMLElBSGxCLE1BQU0xQixFQUFTL0IsU0FBUytELHVCQUF1QjVCLEVBQVloQyxLQUFLWCxRQUtoRVcsRUFBS1YsR0FBQUEsUUFQUCxXQURGb0UsT0FBQUMsU0FBQUwsS0FBQTFCLEVBQUFpQyxRQUFBQyxNQVFJOUQsS0FBS1YsUUFBUXlFLEtBQUtuQyIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IHJlc3RhdXJhbnRzLFxyXG4gIG5laWdoYm9yaG9vZHMsXHJcbiAgY3Vpc2luZXNcclxudmFyIG5ld01hcFxyXG52YXIgbWFya2VycyA9IFtdXHJcblxyXG4vKipcclxuICogRmV0Y2ggbmVpZ2hib3Job29kcyBhbmQgY3Vpc2luZXMgYXMgc29vbiBhcyB0aGUgcGFnZSBpcyBsb2FkZWQuXHJcbiAqL1xyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKGV2ZW50KSA9PiB7XHJcbiAgcmVnaXN0ZXJTZXJ2aWNlV29ya2VyKCk7XHJcbiAgaW5pdE1hcCgpOyAvLyBhZGRlZCBcclxuICBmZXRjaE5laWdoYm9yaG9vZHMoKTtcclxuICBmZXRjaEN1aXNpbmVzKCk7XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIEZldGNoIGFsbCBuZWlnaGJvcmhvb2RzIGFuZCBzZXQgdGhlaXIgSFRNTC5cclxuICovXHJcbmZldGNoTmVpZ2hib3Job29kcyA9ICgpID0+IHtcclxuICBEQkhlbHBlci5mZXRjaE5laWdoYm9yaG9vZHMoKGVycm9yLCBuZWlnaGJvcmhvb2RzKSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2VsZi5uZWlnaGJvcmhvb2RzID0gbmVpZ2hib3Job29kcztcclxuICAgICAgZmlsbE5laWdoYm9yaG9vZHNIVE1MKCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTZXQgbmVpZ2hib3Job29kcyBIVE1MLlxyXG4gKi9cclxuZmlsbE5laWdoYm9yaG9vZHNIVE1MID0gKG5laWdoYm9yaG9vZHMgPSBzZWxmLm5laWdoYm9yaG9vZHMpID0+IHtcclxuICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmVpZ2hib3Job29kcy1zZWxlY3QnKTtcclxuICBuZWlnaGJvcmhvb2RzLmZvckVhY2gobmVpZ2hib3Job29kID0+IHtcclxuICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xyXG4gICAgb3B0aW9uLmlubmVySFRNTCA9IG5laWdoYm9yaG9vZDtcclxuICAgIG9wdGlvbi52YWx1ZSA9IG5laWdoYm9yaG9vZDtcclxuICAgIHNlbGVjdC5hcHBlbmQob3B0aW9uKTtcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEZldGNoIGFsbCBjdWlzaW5lcyBhbmQgc2V0IHRoZWlyIEhUTUwuXHJcbiAqL1xyXG5mZXRjaEN1aXNpbmVzID0gKCkgPT4ge1xyXG4gIERCSGVscGVyLmZldGNoQ3Vpc2luZXMoKGVycm9yLCBjdWlzaW5lcykgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZWxmLmN1aXNpbmVzID0gY3Vpc2luZXM7XHJcbiAgICAgIGZpbGxDdWlzaW5lc0hUTUwoKTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNldCBjdWlzaW5lcyBIVE1MLlxyXG4gKi9cclxuZmlsbEN1aXNpbmVzSFRNTCA9IChjdWlzaW5lcyA9IHNlbGYuY3Vpc2luZXMpID0+IHtcclxuICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3Vpc2luZXMtc2VsZWN0Jyk7XHJcblxyXG4gIGN1aXNpbmVzLmZvckVhY2goY3Vpc2luZSA9PiB7XHJcbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcclxuICAgIG9wdGlvbi5pbm5lckhUTUwgPSBjdWlzaW5lO1xyXG4gICAgb3B0aW9uLnZhbHVlID0gY3Vpc2luZTtcclxuICAgIHNlbGVjdC5hcHBlbmQob3B0aW9uKTtcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpemUgbGVhZmxldCBtYXAsIGNhbGxlZCBmcm9tIEhUTUwuXHJcbiAqL1xyXG5pbml0TWFwID0gKCkgPT4ge1xyXG4gIHNlbGYubmV3TWFwID0gTC5tYXAoJ21hcCcsIHtcclxuICAgICAgICBjZW50ZXI6IFs0MC43MjIyMTYsIC03My45ODc1MDFdLFxyXG4gICAgICAgIHpvb206IDEyLFxyXG4gICAgICAgIHNjcm9sbFdoZWVsWm9vbTogZmFsc2VcclxuICAgICAgfSk7XHJcbiAgTC50aWxlTGF5ZXIoJ2h0dHBzOi8vYXBpLnRpbGVzLm1hcGJveC5jb20vdjQve2lkfS97en0ve3h9L3t5fS5qcGc3MD9hY2Nlc3NfdG9rZW49e21hcGJveFRva2VufScsIHtcclxuICAgIG1hcGJveFRva2VuOiAncGsuZXlKMUlqb2liR1Z0WVNJc0ltRWlPaUpqYW10MFlYVmxhMk13TTNOak0zZHZaSFEwTkRJd1ptVnBJbjAucE9FRmFQWTZlbkNjaElHMjlMbzJTUScsXHJcbiAgICBtYXhab29tOiAxOCxcclxuICAgIGF0dHJpYnV0aW9uOiAnTWFwIGRhdGEgJmNvcHk7IDxhIGhyZWY9XCJodHRwczovL3d3dy5vcGVuc3RyZWV0bWFwLm9yZy9cIj5PcGVuU3RyZWV0TWFwPC9hPiBjb250cmlidXRvcnMsICcgK1xyXG4gICAgICAnPGEgaHJlZj1cImh0dHBzOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS1zYS8yLjAvXCI+Q0MtQlktU0E8L2E+LCAnICtcclxuICAgICAgJ0ltYWdlcnkgwqkgPGEgaHJlZj1cImh0dHBzOi8vd3d3Lm1hcGJveC5jb20vXCI+TWFwYm94PC9hPicsXHJcbiAgICBpZDogJ21hcGJveC5zdHJlZXRzJ1xyXG4gIH0pLmFkZFRvKG5ld01hcCk7XHJcblxyXG4gIHVwZGF0ZVJlc3RhdXJhbnRzKCk7XHJcbn1cclxuLyogd2luZG93LmluaXRNYXAgPSAoKSA9PiB7XHJcbiAgbGV0IGxvYyA9IHtcclxuICAgIGxhdDogNDAuNzIyMjE2LFxyXG4gICAgbG5nOiAtNzMuOTg3NTAxXHJcbiAgfTtcclxuICBzZWxmLm1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpLCB7XHJcbiAgICB6b29tOiAxMixcclxuICAgIGNlbnRlcjogbG9jLFxyXG4gICAgc2Nyb2xsd2hlZWw6IGZhbHNlXHJcbiAgfSk7XHJcbiAgdXBkYXRlUmVzdGF1cmFudHMoKTtcclxufSAqL1xyXG5cclxuLyoqXHJcbiAqIFVwZGF0ZSBwYWdlIGFuZCBtYXAgZm9yIGN1cnJlbnQgcmVzdGF1cmFudHMuXHJcbiAqL1xyXG51cGRhdGVSZXN0YXVyYW50cyA9ICgpID0+IHtcclxuICBjb25zdCBjU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1aXNpbmVzLXNlbGVjdCcpO1xyXG4gIGNvbnN0IG5TZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmVpZ2hib3Job29kcy1zZWxlY3QnKTtcclxuXHJcbiAgY29uc3QgY0luZGV4ID0gY1NlbGVjdC5zZWxlY3RlZEluZGV4O1xyXG4gIGNvbnN0IG5JbmRleCA9IG5TZWxlY3Quc2VsZWN0ZWRJbmRleDtcclxuXHJcbiAgY29uc3QgY3Vpc2luZSA9IGNTZWxlY3RbY0luZGV4XS52YWx1ZTtcclxuICBjb25zdCBuZWlnaGJvcmhvb2QgPSBuU2VsZWN0W25JbmRleF0udmFsdWU7XHJcblxyXG4gIERCSGVscGVyLmZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZChjdWlzaW5lLCBuZWlnaGJvcmhvb2QsIChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVzZXRSZXN0YXVyYW50cyhyZXN0YXVyYW50cyk7XHJcbiAgICAgIGZpbGxSZXN0YXVyYW50c0hUTUwoKTtcclxuICAgIH1cclxuICB9KVxyXG59XHJcblxyXG4vKipcclxuICogQ2xlYXIgY3VycmVudCByZXN0YXVyYW50cywgdGhlaXIgSFRNTCBhbmQgcmVtb3ZlIHRoZWlyIG1hcCBtYXJrZXJzLlxyXG4gKi9cclxucmVzZXRSZXN0YXVyYW50cyA9IChyZXN0YXVyYW50cykgPT4ge1xyXG4gIC8vIFJlbW92ZSBhbGwgcmVzdGF1cmFudHNcclxuICBzZWxmLnJlc3RhdXJhbnRzID0gW107XHJcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudHMtbGlzdCcpO1xyXG4gIHVsLmlubmVySFRNTCA9ICcnO1xyXG5cclxuICAvLyBSZW1vdmUgYWxsIG1hcCBtYXJrZXJzXHJcbiAgaWYgKHNlbGYubWFya2Vycykge1xyXG4gICAgc2VsZi5tYXJrZXJzLmZvckVhY2gobWFya2VyID0+IG1hcmtlci5yZW1vdmUoKSk7XHJcbiAgfVxyXG4gIHNlbGYubWFya2VycyA9IFtdO1xyXG4gIHNlbGYucmVzdGF1cmFudHMgPSByZXN0YXVyYW50cztcclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSBhbGwgcmVzdGF1cmFudHMgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXHJcbiAqL1xyXG5maWxsUmVzdGF1cmFudHNIVE1MID0gKHJlc3RhdXJhbnRzID0gc2VsZi5yZXN0YXVyYW50cykgPT4ge1xyXG4gIGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnRzLWxpc3QnKTtcclxuICByZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xyXG4gICAgdWwuYXBwZW5kKGNyZWF0ZVJlc3RhdXJhbnRIVE1MKHJlc3RhdXJhbnQpKTtcclxuICB9KTtcclxuICBhZGRNYXJrZXJzVG9NYXAoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwuXHJcbiAqL1xyXG5jcmVhdGVSZXN0YXVyYW50SFRNTCA9IChyZXN0YXVyYW50KSA9PiB7XHJcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xyXG5cclxuICBjb25zdCBwaWN0dXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncGljdHVyZScpO1xyXG4gIHBpY3R1cmUuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtcGljdHVyZSc7XHJcbiAgbGkuYXBwZW5kKHBpY3R1cmUpO1xyXG5cclxuICBjb25zdCBzcmMxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc291cmNlJyk7XHJcbiAgc3JjMS5tZWRpYSA9IFwiKG1pbi13aWR0aDogNzUwcHgpXCJcclxuICBzcmMxLnNyY3NldCA9IGAke0RCSGVscGVyLmltYWdlVXJsQmFzZVBhdGh9JHtEQkhlbHBlci5pbWFnZU5hbWVGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpfS04MDBfbGFyZ2VfMXguanBnIDF4YDtcclxuICBzcmMxLnNyY3NldCArPSBgLCR7REJIZWxwZXIuaW1hZ2VVcmxCYXNlUGF0aH0ke0RCSGVscGVyLmltYWdlTmFtZUZvclJlc3RhdXJhbnQocmVzdGF1cmFudCl9LTEyMDBfbGFyZ2VfMnguanBnIDJ4YDtcclxuICBwaWN0dXJlLmFwcGVuZChzcmMxKTtcclxuXHJcbiAgY29uc3Qgc3JjMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NvdXJjZScpO1xyXG4gIHNyYzIubWVkaWEgPSBcIihtaW4td2lkdGg6IDUwMHB4KVwiXHJcbiAgc3JjMi5zcmNzZXQgPSBgJHtEQkhlbHBlci5pbWFnZVVybEJhc2VQYXRofSR7REJIZWxwZXIuaW1hZ2VOYW1lRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KX0tbWVkaXVtLmpwZ2A7XHJcbiAgcGljdHVyZS5hcHBlbmQoc3JjMik7XHJcblxyXG4gIGNvbnN0IGltYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XHJcbiAgaW1hZ2UuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nJztcclxuICBpbWFnZS5zcmMgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XHJcbiAgaW1hZ2UuYWx0ID0gXCJJbWFnZSBvZiB0aGUgcmVzdGF1cmFudCBcIiArIHJlc3RhdXJhbnQubmFtZTtcclxuICBwaWN0dXJlLmFwcGVuZChpbWFnZSk7XHJcblxyXG4gIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gIGNvbnRhaW5lci5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1jb250YWluZXInO1xyXG4gIGxpLmFwcGVuZChjb250YWluZXIpO1xyXG5cclxuICBjb25zdCBjb250ZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgY29udGVudC5jbGFzc05hbWUgPSBcInJlc3RhdXJhbnQtY29udGFpbmVyX19jb250ZW50XCI7XHJcbiAgY29udGFpbmVyLmFwcGVuZChjb250ZW50KTtcclxuXHJcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XHJcbiAgbmFtZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XHJcbiAgY29udGVudC5hcHBlbmQobmFtZSk7XHJcblxyXG4gIGNvbnN0IG5laWdoYm9yaG9vZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICBuZWlnaGJvcmhvb2QuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uZWlnaGJvcmhvb2Q7XHJcbiAgY29udGVudC5hcHBlbmQobmVpZ2hib3Job29kKTtcclxuXHJcbiAgY29uc3QgYWRkcmVzcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICBhZGRyZXNzLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuYWRkcmVzcztcclxuICBjb250ZW50LmFwcGVuZChhZGRyZXNzKTtcclxuXHJcbiAgY29uc3QgbW9yZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcclxuICBtb3JlLmlubmVySFRNTCA9ICdWaWV3IERldGFpbHMnO1xyXG4gIG1vcmUuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ1ZpZXcgZGV0YWlscyBvZiB0aGUgcmVzdGF1cmFudCAnICsgcmVzdGF1cmFudC5uYW1lKTtcclxuICBtb3JlLmhyZWYgPSBEQkhlbHBlci51cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xyXG4gIGNvbnRhaW5lci5hcHBlbmQobW9yZSlcclxuXHJcbiAgcmV0dXJuIGxpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBZGQgbWFya2VycyBmb3IgY3VycmVudCByZXN0YXVyYW50cyB0byB0aGUgbWFwLlxyXG4gKi9cclxuYWRkTWFya2Vyc1RvTWFwID0gKHJlc3RhdXJhbnRzID0gc2VsZi5yZXN0YXVyYW50cykgPT4ge1xyXG4gIHJlc3RhdXJhbnRzLmZvckVhY2gocmVzdGF1cmFudCA9PiB7XHJcbiAgICAvLyBBZGQgbWFya2VyIHRvIHRoZSBtYXBcclxuICAgIGNvbnN0IG1hcmtlciA9IERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgc2VsZi5uZXdNYXApO1xyXG4gICAgbWFya2VyLm9uKFwiY2xpY2tcIiwgb25DbGljayk7XHJcbiAgICBmdW5jdGlvbiBvbkNsaWNrKCkge1xyXG4gICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IG1hcmtlci5vcHRpb25zLnVybDtcclxuICAgIH1cclxuICAgIHNlbGYubWFya2Vycy5wdXNoKG1hcmtlcik7XHJcbiAgfSk7XHJcblxyXG59IFxyXG4vKiBhZGRNYXJrZXJzVG9NYXAgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgcmVzdGF1cmFudHMuZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcclxuICAgIC8vIEFkZCBtYXJrZXIgdG8gdGhlIG1hcFxyXG4gICAgY29uc3QgbWFya2VyID0gREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBzZWxmLm1hcCk7XHJcbiAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdjbGljaycsICgpID0+IHtcclxuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBtYXJrZXIudXJsXHJcbiAgICB9KTtcclxuICAgIHNlbGYubWFya2Vycy5wdXNoKG1hcmtlcik7XHJcbiAgfSk7XHJcbn0gKi8iXX0=
